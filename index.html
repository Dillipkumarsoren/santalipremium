
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Santali Premium</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <style>
        :root {
            --primary: #FF0000;
            --secondary: #990000;
            --dark: #000000;
            --light: #FFFFFF;
            --gray: #1A1A1A;
            --text-light: #E0E0E0;
            --text-dark: #121212;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background-color: var(--dark);
            color: var(--text-light);
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        .app-container {
            max-width: 100%;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }
        
        .no-internet {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 20px;
            text-align: center;
        }
        
        .no-internet i {
            font-size: 60px;
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .no-internet h2 {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .no-internet p {
            font-size: 16px;
            margin-bottom: 20px;
        }
        
        .no-internet button {
            padding: 10px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }
        
        .video-player {
            position: fixed;
            width: 90%;
            max-width: 800px;
            left: 50%;
            top: 20px;
            transform: translateX(-50%);
            aspect-ratio: 16/9;
            background: var(--dark);
            z-index: 1000;
            display: none;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0,0,0,0.8);
            border: 2px solid var(--primary);
            transition: all 0.3s ease;
            touch-action: none;
        }
        
        .video-player.dragging {
            transition: none;
            box-shadow: 0 0 30px rgba(255,0,0,0.5);
        }
        
        .video-player.top-position {
            top: 20px;
            bottom: auto;
            transform: translateX(-50%);
        }
        
        .video-player.bottom-position {
            top: auto;
            bottom: 20px;
            transform: translateX(-50%);
        }
        
        .video-player.left-position {
            left: 20px;
            right: auto;
            transform: none;
        }
        
        .video-player.right-position {
            left: auto;
            right: 20px;
            transform: none;
        }
        
        .video-player-container {
            position: relative;
            width: 100%;
            height: 100%;
            background: #000;
        }
        
        .video-player iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .video-player-header {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.7);
            padding: 8px 12px;
            z-index: 20;
            cursor: move;
            touch-action: none;
            transition: opacity 0.3s ease;
        }
        
        .video-player-title {
            color: white;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
            padding-right: 10px;
            cursor: move;
        }
        
        .video-player-close {
            width: 24px;
            height: 24px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            border: 2px solid var(--dark);
            outline: none;
            flex-shrink: 0;
            z-index: 21;
            position: relative;
            opacity: 1 !important;
        }
        
        .video-player-loading {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 5;
        }
        
        .video-player-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }
        
        .video-player-refresh {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--primary);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            display: none;
            cursor: pointer;
            z-index: 15;
            border: none;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .menu-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            z-index: 400;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            transition: all 0.3s;
        }
        
        .menu-btn:hover {
            transform: scale(1.1);
        }
        
        .menu-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--light);
            color: var(--primary);
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .menu-popup {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 200px;
            max-width: 90%;
            background: var(--gray);
            border-radius: 8px;
            padding: 10px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            border: 1px solid var(--primary);
            z-index: 450;
            display: none;
        }
        
        .menu-popup.show {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 0 15px 5px;
            border-bottom: 1px solid #333;
        }
        
        .menu-title {
            font-weight: bold;
            color: var(--primary);
        }
        
        .menu-close {
            color: var(--text-light);
            cursor: pointer;
        }
        
        .menu-item {
            padding: 10px 15px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .menu-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--primary);
        }
        
        .menu-item i {
            width: 20px;
            text-align: center;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal-overlay.show {
            display: flex;
        }
        
        .modal-content {
            background: var(--gray);
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            padding: 20px;
            border: 1px solid var(--primary);
            position: relative;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .modal-close {
            font-size: 20px;
            cursor: pointer;
            color: var(--text-light);
        }
        
        .modal-body {
            font-size: 14px;
            line-height: 1.6;
        }
        
        .modal-body h3 {
            margin: 15px 0 10px;
            color: var(--primary);
        }
        
        .modal-body p {
            margin-bottom: 10px;
        }
        
        .modal-body ul {
            padding-left: 20px;
            margin-bottom: 15px;
        }
        
        .share-modal {
            max-width: 400px;
        }
        
        .share-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .share-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: background 0.2s;
        }
        
        .share-option:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .share-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 8px;
            color: white;
        }
        
        .share-icon.telegram {
            background: #0088cc;
        }
        
        .share-icon.whatsapp {
            background: #25D366;
        }
        
        .share-icon.facebook {
            background: #3b5998;
        }
        
        .share-icon.twitter {
            background: #1DA1F2;
        }
        
        .share-icon.link {
            background: var(--primary);
        }
        
        .share-label {
            font-size: 12px;
            text-align: center;
        }
        
        .main-app {
            display: block;
            height: 100%;
        }
        
        .header {
            background: var(--dark);
            color: var(--light);
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo {
            font-size: 22px;
            font-weight: bold;
            display: flex;
            align-items: center;
            color: var(--light);
            transition: all 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
        }
        
        .logo.hidden {
            opacity: 0;
            width: 0;
            margin: 0;
            padding: 0;
            transform: translateX(-10px);
        }
        
        .logo i {
            margin-right: 10px;
            color: var(--primary);
            font-size: 24px;
        }
        
        .search-container {
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            width: auto;
            margin-left: auto;
            flex-grow: 1;
            justify-content: flex-end;
        }
        
        .search-box {
            display: flex;
            align-items: center;
            background-color: var(--dark);
            border: 2px solid var(--primary);
            border-radius: 50px;
            height: 40px;
            width: 40px;
            overflow: hidden;
            transition: width 0.4s ease, padding 0.4s ease;
        }
        
        .search-box.active {
            width: 100%;
            padding: 0 10px;
        }
        
        .search-input {
            flex: 1;
            background: transparent;
            border: none;
            outline: none;
            color: var(--text-light);
            font-size: 16px;
            padding: 0 8px;
            display: none;
            min-width: 0;
        }
        
        .search-box.active .search-input {
            display: block;
        }
        
        .search-icon {
            width: 40px;
            height: 40px;
            min-width: 40px;
            min-height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            flex-shrink: 0;
        }
        
        .search-icon i {
            color: var(--text-light);
            font-size: 16px;
        }
        
        .back-btn {
            color: var(--primary);
            font-size: 20px;
            cursor: pointer;
            margin-right: 5px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 0;
            overflow: hidden;
        }
        
        .back-btn.active {
            opacity: 1;
            visibility: visible;
            width: auto;
            margin-right: 8px;
        }
        
        .title-bar {
            display: flex;
            align-items: center;
            margin-right: 10px;
            font-size: 18px;
            font-weight: bold;
            color: var(--primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 120px;
            gap: 10px;
        }
        
        .refresh-btn {
            color: var(--primary);
            font-size: 20px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .refresh-btn.rotating {
            animation: rotate 1s linear infinite;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .categories {
            display: flex;
            gap: 12px;
            padding: 10px 15px;
            border-bottom: 1px solid #333;
            position: sticky;
            top: 60px;
            background: var(--dark);
            z-index: 90;
            overflow-x: auto;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
            justify-content: center;
        }
        
        .categories::-webkit-scrollbar {
            display: none;
        }
        
        .category-tab {
            padding: 5px 0;
            color: var(--text-light);
            cursor: pointer;
            position: relative;
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .category-tab.active {
            color: var(--primary);
        }
        
        .category-tab.active:after {
            content: '';
            position: absolute;
            bottom: -11px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary);
        }
        
        .content-section {
            padding: 12px;
            padding-bottom: 70px;
            overflow-y: auto;
            height: calc(100vh - 120px);
            -webkit-overflow-scrolling: touch;
        }
        
        .video-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .video-card {
            background: var(--gray);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: all 0.3s;
            cursor: pointer;
            border: 1px solid #333;
            position: relative;
        }
        
        .video-card:hover {
            border-color: var(--primary);
        }
        
        .video-card.disabled {
            position: relative;
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        .video-card.disabled::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1;
        }
        
        .video-card.disabled .thumbnail {
            filter: grayscale(80%);
        }
        
        .video-card.disabled .disabled-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 2;
            text-align: center;
        }
        
        .thumbnail {
            position: relative;
            height: 0;
            padding-bottom: 56.25%;
            overflow: hidden;
            background-color: #000;
            cursor: pointer;
        }
        
        .thumbnail img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }
        
        .video-card:active .thumbnail img {
            transform: scale(0.98);
        }
        
        .video-info {
            padding: 8px;
            position: relative;
            min-height: 120px;
            display: flex;
            flex-direction: column;
        }
        
        .video-content {
            flex: 1;
            margin-bottom: 30px;
        }
        
        .video-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 5px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.3;
        }
        
        .video-description {
            font-size: 12px;
            color: #aaa;
            margin-top: 5px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.3;
        }
        
        .video-badges {
            position: absolute;
            bottom: 8px;
            left: 8px;
            right: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .youtube-logo {
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: var(--primary);
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .youtube-logo i {
            font-size: 18px;
            color: var(--primary);
        }
        
        .copy-btn {
            background: transparent;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 14px;
            padding: 0;
            margin-left: 5px;
        }
        
        .premium-badge {
            background: linear-gradient(90deg, #FFD700, #FFA500, #FFD700);
            background-size: 200% 100%;
            color: black;
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 10px;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            animation: premiumGlow 2s linear infinite;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }
        
        @keyframes premiumGlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .premium-badge i {
            font-size: 10px;
        }
        
        .video-category {
            background: var(--primary);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 10px;
            text-transform: uppercase;
        }
        
        .loading-container {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }
        
        .skeleton {
            background: linear-gradient(90deg, #1a1a1a 25%, #2a2a2a 50%, #1a1a1a 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            border-radius: 4px;
        }
        
        @keyframes shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        .skeleton-thumbnail {
            height: 0;
            padding-bottom: 56.25%;
            width: 100%;
            margin-bottom: 8px;
        }
        
        .skeleton-title {
            height: 16px;
            width: 80%;
            margin-bottom: 6px;
        }
        
        .skeleton-description {
            height: 12px;
            width: 90%;
            margin-bottom: 6px;
        }
        
        .skeleton-meta {
            height: 12px;
            width: 40%;
        }
        
        .empty-album {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 20px;
            text-align: center;
            color: #aaa;
        }
        
        .empty-album i {
            font-size: 40px;
            margin-bottom: 10px;
        }
        
        .toast {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 1000;
            display: none;
        }
        
        .toast.show {
            display: block;
            animation: fadeInOut 2s;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }
        
        /* Upload button styles */
        .upload-btn {
            position: fixed;
            bottom: 80px;
            right: 80px;
            width: 50px;
            height: 50px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            z-index: 400;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            transition: all 0.3s;
            transform: translateY(20px);
            opacity: 0;
            pointer-events: none;
        }
        
        .upload-btn.visible {
            transform: translateY(0);
            opacity: 1;
            pointer-events: auto;
        }
        
        .upload-btn:hover {
            transform: translateY(0) scale(1.1);
        }
        
        /* Telegram button styles */
        .telegram-btn {
            position: fixed;
            bottom: 80px;
            right: 140px;
            width: 50px;
            height: 50px;
            background: #0088cc;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            z-index: 400;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            transition: all 0.3s;
            transform: translateY(20px);
            opacity: 0;
            pointer-events: none;
        }
        
        .telegram-btn.visible {
            transform: translateY(0);
            opacity: 1;
            pointer-events: auto;
        }
        
        .telegram-btn:hover {
            transform: translateY(0) scale(1.1);
        }
        
        /* Upload modal styles */
        .upload-modal {
            max-width: 500px;
        }
        
        .upload-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .form-group label {
            font-size: 14px;
            color: var(--text-light);
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #333;
            background: #2a2a2a;
            color: var(--text-light);
            font-size: 14px;
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .submit-btn {
            padding: 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .submit-btn:hover {
            background: var(--secondary);
        }
        
        .detect-btn {
            padding: 8px 12px;
            background: #333;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 12px;
            cursor: pointer;
            align-self: flex-start;
        }
        
        .detect-btn:hover {
            background: #444;
        }
        
        @media (min-width: 480px) {
            .search-box {
                height: 44px;
                width: 44px;
            }
            
            .search-icon {
                width: 44px;
                height: 44px;
                min-width: 44px;
                min-height: 44px;
            }
            
            .search-box.active {
                padding: 0 12px;
            }
            
            .title-bar {
                max-width: 150px;
            }
        }
        
        @media (min-width: 768px) {
            .video-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .search-box {
                height: 48px;
                width: 48px;
            }
            
            .search-icon {
                width: 48px;
                height: 48px;
                min-width: 48px;
                min-height: 48px;
            }
            
            .search-box.active {
                width: 300px;
                padding: 0 15px;
            }
            
            .menu-popup {
                width: 220px;
            }
            
            .title-bar {
                max-width: 200px;
            }
        }
        
        @media (min-width: 992px) {
            .video-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 15px;
            }
            
            .content-section {
                padding: 15px;
                padding-bottom: 70px;
            }
            
            .title-bar {
                max-width: 250px;
            }
        }
        
        @media screen and (max-width: 767px) {
            input, textarea, select {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="no-internet" id="noInternet">
        <i class="fas fa-wifi"></i>
        <h2>No Internet Connection</h2>
        <p>Please check your network settings and try again</p>
        <button id="retryConnection">Try Again</button>
    </div>

    <div class="video-player top-position" id="videoPlayer">
        <div class="video-player-container" id="videoPlayerContainer">
            <div class="video-player-header" id="videoPlayerHeader">
                <div class="video-player-title" id="videoPlayerTitle"></div>
                <button class="video-player-close" id="videoPlayerClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="video-player-loading" id="videoPlayerLoading">
                <div class="video-player-spinner"></div>
            </div>
            <button class="video-player-refresh" id="videoPlayerRefresh">
                <i class="fas fa-sync-alt"></i> Refresh
            </button>
            <iframe id="videoPlayerIframe" frameborder="0" allowfullscreen></iframe>
        </div>
    </div>
    
    <!-- Upload Button -->
    <div class="upload-btn" id="uploadBtn">
        <i class="fas fa-cloud-arrow-up"></i>
    </div>
    
    <!-- Telegram Button -->
    <div class="telegram-btn" id="telegramBtn">
        <i class="fab fa-telegram"></i>
    </div>
    
    <!-- Menu Button -->
    <div class="menu-btn" id="menuBtn">
        <i class="fas fa-envelope"></i>
        <div class="menu-badge">1</div>
    </div>
    
    <div class="menu-popup" id="menuPopup">
        <div class="menu-header">
            <div class="menu-title">Menu</div>
            <div class="menu-close" id="menuClose">
                <i class="fas fa-times"></i>
            </div>
        </div>
        <div class="menu-item" id="privacyPolicyBtn">
            <i class="fas fa-user-shield"></i>
            <span>Privacy Policy</span>
        </div>
        <div class="menu-item" id="disclaimerBtn">
            <i class="fas fa-exclamation-triangle"></i>
            <span>Disclaimer</span>
        </div>
        <div class="menu-item" id="termsBtn">
            <i class="fas fa-file-contract"></i>
            <span>Terms & Conditions</span>
        </div>
        <div class="menu-item" id="notificationBtn">
            <i class="fas fa-envelope"></i>
            <span>Notifications</span>
        </div>
    </div>
    
    <!-- Upload Modal -->
    <div class="modal-overlay" id="uploadModal">
        <div class="modal-content upload-modal">
            <div class="modal-header">
                <div class="modal-title">Upload YouTube Video</div>
                <div class="modal-close" id="uploadClose">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            <div class="modal-body">
                <form class="upload-form" id="uploadForm">
                    <div class="form-group">
                        <label for="youtubeUrl">YouTube URL</label>
                        <input type="url" id="youtubeUrl" placeholder="https://www.youtube.com/watch?v=..." required>
                        <button type="button" class="detect-btn" id="detectBtn">Auto Detect</button>
                    </div>
                    <div class="form-group">
                        <label for="videoTitle">Title</label>
                        <input type="text" id="videoTitle" placeholder="Video title" required>
                    </div>
                    <div class="form-group">
                        <label for="videoDescription">Description</label>
                        <textarea id="videoDescription" placeholder="Video description"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="videoCategory">Category</label>
                        <select id="videoCategory" required>
                            <option value="album">Album</option>
                            <option value="movie">Movie</option>
                            <option value="comedy">Comedy</option>
                            <option value="reels">Reels</option>
                        </select>
                    </div>
                    <button type="submit" class="submit-btn">Upload Video</button>
                </form>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="privacyModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Privacy Policy</div>
                <div class="modal-close" id="privacyClose">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            <div class="modal-body">
                <h3>Information We Collect</h3>
                <p>We collect information to provide better services to all our users. The information we collect includes:</p>
                <ul>
                    <li>Device information (model, operating system version, unique device identifiers)</li>
                    <li>Log information (details of how you used our service, device event information)</li>
                    <li>Location information (if you enable location services)</li>
                </ul>
                
                <h3>How We Use Information</h3>
                <p>We use the information we collect to:</p>
                <ul>
                    <li>Provide, maintain, and improve our services</li>
                    <li>Develop new services</li>
                    <li>Provide personalized content</li>
                    <li>Measure performance and analyze usage</li>
                </ul>
                
                <h3>Information Sharing</h3>
                <p>We do not share personal information with companies, organizations, or individuals outside of our organization except in the following cases:</p>
                <ul>
                    <li>With your consent</li>
                    <li>For legal reasons</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="disclaimerModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Disclaimer</div>
                <div class="modal-close" id="disclaimerClose">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            <div class="modal-body">
                <h3>Content Disclaimer</h3>
                <p>The content provided in this application is for informational and entertainment purposes only. We do not claim ownership of any video content displayed through YouTube's API.</p>
                
                <h3>Accuracy of Information</h3>
                <p>While we strive to provide accurate information, we make no representations or warranties of any kind, express or implied, about the completeness, accuracy, reliability, suitability, or availability with respect to the content contained in the application.</p>
                
                <h3>Third-Party Content</h3>
                <p>This application may contain links to third-party websites or services that are not owned or controlled by us. We have no control over, and assume no responsibility for, the content, privacy policies, or practices of any third-party websites or services.</p>
                
                <h3>Limitation of Liability</h3>
                <p>In no event shall we be liable for any loss or damage including without limitation, indirect or consequential loss or damage, or any loss or damage whatsoever arising from loss of data or profits arising out of, or in connection with, the use of this application.</p>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="termsModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Terms & Conditions</div>
                <div class="modal-close" id="termsClose">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            <div class="modal-body">
                <h3>Acceptance of Terms</h3>
                <p>By accessing or using our application, you agree to be bound by these Terms. If you disagree with any part of the terms, then you may not access the application.</p>
                
                <h3>User Conduct</h3>
                <p>You agree not to use the application to:</p>
                <ul>
                    <li>Violate any laws or regulations</li>
                    <li>Infringe the intellectual property rights of others</li>
                    <li>Distribute viruses or other harmful computer code</li>
                    <li>Collect information about others without their consent</li>
                </ul>
                
                <h3>Account Termination</h3>
                <p>We may terminate or suspend access to our application immediately, without prior notice or liability, for any reason whatsoever, including without limitation if you breach the Terms.</p>
                
                <h3>Changes to Terms</h3>
                <p>We reserve the right, at our sole discretion, to modify or replace these Terms at any time. We will provide notice of any changes by posting the new Terms on this page.</p>
                
                <h3>Governing Law</h3>
                <p>These Terms shall be governed and construed in accordance with the laws of the country in which our company is registered, without regard to its conflict of law provisions.</p>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="notificationModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Notifications</div>
                <div class="modal-close" id="notificationClose">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            <div class="modal-body">
                <h3>Important Notice</h3>
                <p>Jahai ko nowa aap re YouTube video doho sana peya ing aa WhatsApp channel re link bhejai pe: ( https://whatsapp.com/channel/0029Va9EkVfLikgDuskIqr3P ) . Original content hui koma. first ale le nel aa apeya content R YouTube channel judi Genuine hui kowa , enkhan apeya video link nowa aap re jaga nam lagid daw ( approve ) nam aay.</p>
                
                <h3>Notification Settings</h3>
                <p>You can manage your notification preferences in your device settings.</p>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="shareModal">
        <div class="modal-content share-modal">
            <div class="modal-header">
                <div class="modal-title">Share Content</div>
                <div class="modal-close" id="shareClose">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            <div class="modal-body">
                <p>Share this content with your friends:</p>
                <div class="share-options">
                    <div class="share-option" id="shareTelegram">
                        <div class="share-icon telegram">
                            <i class="fab fa-telegram"></i>
                        </div>
                        <div class="share-label">Telegram</div>
                    </div>
                    <div class="share-option" id="shareWhatsApp">
                        <div class="share-icon whatsapp">
                            <i class="fab fa-whatsapp"></i>
                        </div>
                        <div class="share-label">WhatsApp</div>
                    </div>
                    <div class="share-option" id="shareFacebook">
                        <div class="share-icon facebook">
                            <i class="fab fa-facebook-f"></i>
                        </div>
                        <div class="share-label">Facebook</div>
                    </div>
                    <div class="share-option" id="shareTwitter">
                        <div class="share-icon twitter">
                            <i class="fab fa-twitter"></i>
                        </div>
                        <div class="share-label">Twitter</div>
                    </div>
                    <div class="share-option" id="shareLink">
                        <div class="share-icon link">
                            <i class="fas fa-link"></i>
                        </div>
                        <div class="share-label">Copy Link</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="main-app" id="mainApp">
        <header class="header">
            <div class="logo" id="appLogo">
                <i class="fa-solid fa-circle-play"></i>
                <span>Santali Premium</span>
            </div>
            
            <div class="search-container">
                <div class="back-btn" id="backButton">
                    <i class="fas fa-arrow-left"></i>
                </div>
                <div class="title-bar">
                    <i class="fa-solid fa-cloud-arrow-up" id="uploadButton"></i>
                    <i class="fa-solid fa-share" id="shareButton"></i>
                    <i class="fas fa-sync-alt refresh-btn" id="refreshButton"></i>
                </div>
                <div class="search-box" id="searchBox">
                    <input type="text" class="search-input" id="searchInput" placeholder="Search videos...">
                    <div class="search-icon" id="searchButton">
                        <i class="fas fa-search"></i>
                    </div>
                </div>
            </div>
        </header>
        
        <div class="categories" id="categories">
            <div class="category-tab active" data-category="all" aria-label="All videos">
                <i class="fa fa-th-list"></i>
                <span>All</span>
            </div>
            <div class="category-tab" data-category="album" aria-label="Albums">
                <i class="fa fa-play-circle"></i>
                <span>Album</span>
            </div>
            <div class="category-tab" data-category="movie" aria-label="Movies">
                <i class="fas fa-film"></i>
                <span>Movie</span>
            </div>
            <div class="category-tab" data-category="comedy" aria-label="Comedy">
                <i class="fas fa-laugh-squint"></i>
                <span>Comedy</span>
            </div>
            <div class="category-tab" data-category="reels" aria-label="Reels">
                <i class="fab fa-instagram"></i>
                <span>Reels</span>
            </div>
        </div>
        
        <div class="content-section" id="videosSection">
            <div class="video-grid" id="videosGrid">
                <!-- Videos will be loaded here -->
            </div>
            <div class="loading-container" id="loadingContainer">
                <div class="loading-spinner"></div>
            </div>
        </div>
    </div>

    <div class="toast" id="toast">Link copied to clipboard!</div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCGZnlhY4CpNbK5Jx9csh8xwLFssuMivR4",
            authDomain: "sorenstarmedia.firebaseapp.com",
            databaseURL: "https://sorenstarmedia-default-rtdb.firebaseio.com",
            projectId: "sorenstarmedia",
            storageBucket: "sorenstarmedia.appspot.com",
            messagingSenderId: "84788314880",
            appId: "1:84788314880:web:bc25c6977296ae1f15a9e5",
            measurementId: "G-6QS5NJCR8F"
        };

        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        
        // DOM Elements
        const mainApp = document.getElementById('mainApp');
        const searchInput = document.getElementById('searchInput');
        const searchButton = document.getElementById('searchButton');
        const searchBox = document.getElementById('searchBox');
        const backButton = document.getElementById('backButton');
        const appLogo = document.getElementById('appLogo');
        const videosGrid = document.getElementById('videosGrid');
        const loadingContainer = document.getElementById('loadingContainer');
        const videoPlayer = document.getElementById('videoPlayer');
        const videoPlayerContainer = document.getElementById('videoPlayerContainer');
        const videoPlayerHeader = document.getElementById('videoPlayerHeader');
        const videoPlayerTitle = document.getElementById('videoPlayerTitle');
        const videoPlayerClose = document.getElementById('videoPlayerClose');
        const videoPlayerLoading = document.getElementById('videoPlayerLoading');
        const videoPlayerRefresh = document.getElementById('videoPlayerRefresh');
        const videoPlayerIframe = document.getElementById('videoPlayerIframe');
        const noInternet = document.getElementById('noInternet');
        const retryConnection = document.getElementById('retryConnection');
        const videosSection = document.getElementById('videosSection');
        const categories = document.getElementById('categories');
        const categoryTabs = document.querySelectorAll('.category-tab');
        const menuBtn = document.getElementById('menuBtn');
        const menuPopup = document.getElementById('menuPopup');
        const menuClose = document.getElementById('menuClose');
        const privacyPolicyBtn = document.getElementById('privacyPolicyBtn');
        const disclaimerBtn = document.getElementById('disclaimerBtn');
        const termsBtn = document.getElementById('termsBtn');
        const notificationBtn = document.getElementById('notificationBtn');
        const privacyModal = document.getElementById('privacyModal');
        const disclaimerModal = document.getElementById('disclaimerModal');
        const termsModal = document.getElementById('termsModal');
        const notificationModal = document.getElementById('notificationModal');
        const shareModal = document.getElementById('shareModal');
        const privacyClose = document.getElementById('privacyClose');
        const disclaimerClose = document.getElementById('disclaimerClose');
        const termsClose = document.getElementById('termsClose');
        const notificationClose = document.getElementById('notificationClose');
        const shareClose = document.getElementById('shareClose');
        const shareTelegram = document.getElementById('shareTelegram');
        const shareWhatsApp = document.getElementById('shareWhatsApp');
        const shareFacebook = document.getElementById('shareFacebook');
        const shareTwitter = document.getElementById('shareTwitter');
        const shareLink = document.getElementById('shareLink');
        const refreshButton = document.getElementById('refreshButton');
        const toast = document.getElementById('toast');
        const titleBar = document.querySelector('.title-bar');
        const uploadBtn = document.getElementById('uploadBtn');
        const uploadModal = document.getElementById('uploadModal');
        const uploadClose = document.getElementById('uploadClose');
        const uploadForm = document.getElementById('uploadForm');
        const youtubeUrl = document.getElementById('youtubeUrl');
        const videoTitle = document.getElementById('videoTitle');
        const videoDescription = document.getElementById('videoDescription');
        const videoCategory = document.getElementById('videoCategory');
        const detectBtn = document.getElementById('detectBtn');
        const telegramBtn = document.getElementById('telegramBtn');
        const uploadButton = document.getElementById('uploadButton');
        const shareButton = document.getElementById('shareButton');

        // Global variables
        let videos = [];
        let currentPlayingVideo = null;
        let currentCategory = 'all';
        let searchTimeout = null;
        let isDraggingPlayer = false;
        let playerStartX = 0;
        let playerStartY = 0;
        let playerOffsetX = 0;
        let playerOffsetY = 0;
        let playerDirection = 'down';
        let playerPosition = 'top';
        let hideControlsTimeout = null;
        let isMouseOverPlayer = false;
        let controlsVisible = true;
        let touchStartTime = 0;
        let lastTapTime = 0;
        let autoScrollInterval = null;
        let currentLinkIndex = 0;
        let buttonsVisible = false;
        const linksToRotate = [
            "https://whatsapp.com/channel/0029Va9EkVfLikgDuskIqr3P",
            "https://t.me/santali_premium",
            "https://www.youtube.com/@santalipremium"
        ];

        // Initialize app
        function initApp() {
            checkInternetConnection();
            loadVideos();
            setupEventListeners();
            startLinkRotation();
        }

        // Check internet connection
        function checkInternetConnection() {
            if (!navigator.onLine) {
                noInternet.style.display = 'flex';
                mainApp.style.display = 'none';
            }
        }

        // Setup all event listeners
        function setupEventListeners() {
            // Network status listeners
            window.addEventListener('online', () => {
                noInternet.style.display = 'none';
                mainApp.style.display = 'block';
            });
            
            window.addEventListener('offline', () => {
                noInternet.style.display = 'flex';
                mainApp.style.display = 'none';
            });
            
            retryConnection.addEventListener('click', () => {
                if (navigator.onLine) {
                    noInternet.style.display = 'none';
                    mainApp.style.display = 'block';
                }
            });

            // Search functionality
            searchButton.addEventListener('click', (e) => {
                e.stopPropagation();
                if (!searchBox.classList.contains('active')) {
                    activateSearch();
                } else if (searchInput.value.trim() !== '') {
                    searchVideos();
                }
            });
            
            searchInput.addEventListener('input', () => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    if (searchInput.value.trim() !== '') {
                        searchVideos();
                    } else {
                        filterVideosByCategory();
                    }
                }, 300);
            });
            
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && searchInput.value.trim() !== '') {
                    searchVideos();
                }
            });
            
            backButton.addEventListener('click', () => {
                deactivateSearch();
                filterVideosByCategory();
            });

            // Category filtering
            categoryTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    categoryTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentCategory = tab.dataset.category;
                    filterVideosByCategory();
                });
            });

            // Video player controls
            videoPlayerClose.addEventListener('click', closeVideoPlayer);
            videoPlayerRefresh.addEventListener('click', () => {
                if (currentPlayingVideo) {
                    videoPlayerLoading.style.display = 'flex';
                    videoPlayerRefresh.style.display = 'none';
                    videoPlayerIframe.src = videoPlayerIframe.src;
                }
            });

            // Menu and modals
            menuBtn.addEventListener('click', toggleMenuPopup);
            menuClose.addEventListener('click', toggleMenuPopup);
            
            document.addEventListener('click', (e) => {
                if (!menuPopup.contains(e.target) && e.target !== menuBtn && 
                    !menuBtn.contains(e.target)) {
                    menuPopup.classList.remove('show');
                }
            });

            privacyPolicyBtn.addEventListener('click', () => {
                toggleMenuPopup();
                privacyModal.classList.add('show');
            });
            
            disclaimerBtn.addEventListener('click', () => {
                toggleMenuPopup();
                disclaimerModal.classList.add('show');
            });
            
            termsBtn.addEventListener('click', () => {
                toggleMenuPopup();
                termsModal.classList.add('show');
            });
            
            notificationBtn.addEventListener('click', () => {
                toggleMenuPopup();
                notificationModal.classList.add('show');
            });

            privacyClose.addEventListener('click', () => privacyModal.classList.remove('show'));
            disclaimerClose.addEventListener('click', () => disclaimerModal.classList.remove('show'));
            termsClose.addEventListener('click', () => termsModal.classList.remove('show'));
            notificationClose.addEventListener('click', () => notificationModal.classList.remove('show'));
            shareClose.addEventListener('click', () => shareModal.classList.remove('show'));
            
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal-overlay')) {
                    e.target.classList.remove('show');
                }
            });

            // Upload functionality
            uploadBtn.addEventListener('click', () => {
                uploadModal.classList.add('show');
            });
            
            uploadButton.addEventListener('click', () => {
                uploadModal.classList.add('show');
            });
            
            uploadClose.addEventListener('click', () => {
                uploadModal.classList.remove('show');
            });
            
            detectBtn.addEventListener('click', detectVideoInfo);
            
            // Auto-detect when URL changes
            youtubeUrl.addEventListener('change', detectVideoInfo);
            youtubeUrl.addEventListener('blur', detectVideoInfo);
            
            uploadForm.addEventListener('submit', (e) => {
                e.preventDefault();
                uploadVideo();
            });

            // Telegram button functionality
            telegramBtn.addEventListener('click', () => {
                window.open('https://t.me/santali_premium', '_blank');
            });

            // Share button functionality
            shareButton.addEventListener('click', () => {
                shareModal.classList.add('show');
            });
            
            // Sharing functionality
            shareTelegram.addEventListener('click', () => {
                shareContent('telegram');
            });
            
            shareWhatsApp.addEventListener('click', () => {
                shareContent('whatsapp');
            });
            
            shareFacebook.addEventListener('click', () => {
                shareContent('facebook');
            });
            
            shareTwitter.addEventListener('click', () => {
                shareContent('twitter');
            });
            
            shareLink.addEventListener('click', () => {
                copyToClipboard(linksToRotate[currentLinkIndex]);
                showToast('Link copied to clipboard!');
                shareModal.classList.remove('show');
            });

            // Video player controls visibility
            videoPlayer.addEventListener('mouseenter', () => {
                isMouseOverPlayer = true;
                showPlayerControls();
            });

            videoPlayer.addEventListener('mouseleave', () => {
                isMouseOverPlayer = false;
                if (!isDraggingPlayer) {
                    startHideControlsTimer();
                }
            });

            // Hide controls when video starts playing
            videoPlayer.addEventListener('mousemove', () => {
                if (controlsVisible) {
                    showPlayerControls();
                    startHideControlsTimer();
                }
            });

            // Touch to show/hide controls
            videoPlayerContainer.addEventListener('click', (e) => {
                if (e.target === videoPlayerContainer || e.target === videoPlayerIframe) {
                    togglePlayerControls();
                }
            });

            // Double tap to toggle fullscreen
            videoPlayerContainer.addEventListener('touchstart', (e) => {
                const currentTime = new Date().getTime();
                const tapLength = currentTime - lastTapTime;
                
                if (tapLength < 300 && tapLength > 0) {
                    // Double tap detected
                    e.preventDefault();
                    toggleFullscreen();
                }
                
                lastTapTime = currentTime;
            });

            // Refresh button functionality
            refreshButton.addEventListener('click', () => {
                // Add rotation animation
                refreshButton.classList.add('rotating');
                
                // Scroll to top
                videosSection.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
                
                // Reload videos after a short delay
                setTimeout(() => {
                    loadVideos();
                    refreshButton.classList.remove('rotating');
                }, 1000);
            });
        }

        // Toggle menu popup and buttons
        function toggleMenuPopup() {
            menuPopup.classList.toggle('show');
            toggleButtons();
        }

        // Toggle buttons visibility with animation
        function toggleButtons() {
            buttonsVisible = !buttonsVisible;
            
            if (buttonsVisible) {
                uploadBtn.classList.add('visible');
                telegramBtn.classList.add('visible');
            } else {
                uploadBtn.classList.remove('visible');
                telegramBtn.classList.remove('visible');
            }
        }

        // Upload video functions
        function detectVideoInfo() {
            const url = youtubeUrl.value.trim();
            if (!url) {
                showToast('Please enter a YouTube URL');
                return;
            }
            
            const videoId = getYouTubeId(url);
            if (!videoId) {
                showToast('Invalid YouTube URL');
                return;
            }
            
            // Show loading state
            videoTitle.value = "Loading video info...";
            videoDescription.value = "Loading video description...";
            
            // Fetch video info from YouTube oEmbed API
            fetch(`https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=${videoId}&format=json`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    // Set the title and description from the YouTube data
                    videoTitle.value = data.title;
                    videoDescription.value = data.title; // Using title as description since oEmbed doesn't provide description
                    
                    // Auto-select a category based on some logic (random in this case)
                    const categories = ['album', 'movie', 'comedy', 'reels'];
                    const randomCategory = categories[Math.floor(Math.random() * categories.length)];
                    videoCategory.value = randomCategory;
                    
                    showToast('Video info detected successfully');
                })
                .catch(error => {
                    console.error('Error fetching video info:', error);
                    // Fallback to using video ID as title if API fails
                    videoTitle.value = `Santali Video ${videoId}`;
                    videoDescription.value = `Santali Video ${videoId}`;
                    showToast('Using default title (YouTube API failed)');
                });
        }
        
        function uploadVideo() {
            const url = youtubeUrl.value.trim();
            const title = videoTitle.value.trim();
            const category = videoCategory.value;
            
            if (!url || !title || !category) {
                showToast('Please fill all required fields');
                return;
            }
            
            const videoId = getYouTubeId(url);
            if (!videoId) {
                showToast('Invalid YouTube URL');
                return;
            }
            
            // Create a new video object with timestamp
            const newVideo = {
                url: url,
                title: title,
                description: videoDescription.value.trim(),
                category: category,
                isPremium: true,
                enabled: false, // Videos are disabled by default
                createdAt: firebase.database.ServerValue.TIMESTAMP,
                views: 0
            };
            
            // Save to Firebase
            const videosRef = database.ref('videos');
            const newVideoRef = videosRef.push();
            
            newVideoRef.set(newVideo)
                .then(() => {
                    showToast('Video uploaded successfully! It will be reviewed by admin.');
                    uploadForm.reset();
                    uploadModal.classList.remove('show');
                })
                .catch(error => {
                    console.error('Error uploading video:', error);
                    showToast('Error uploading video. Please try again.');
                });
        }

        // Load videos from Firebase
        function loadVideos() {
            try {
                showLoadingSkeleton();
                
                const videosRef = database.ref('videos');
                // Order by createdAt in descending order (newest first)
                videosRef.orderByChild('createdAt').on('value', (snapshot) => {
                    if (snapshot.exists()) {
                        videos = [];
                        snapshot.forEach(childSnapshot => {
                            const videoData = childSnapshot.val();
                            if (videoData.url && getYouTubeId(videoData.url)) {
                                const videoId = childSnapshot.key || generateUniqueId();
                                videos.push({
                                    id: videoId,
                                    ...videoData,
                                    title: videoData.title || "Untitled Video",
                                    category: videoData.category || "general",
                                    labels: videoData.labels || [],
                                    isPremium: videoData.isPremium !== undefined ? videoData.isPremium : true,
                                    creator: videoData.creator || "Unknown Creator",
                                    enabled: videoData.enabled || false
                                });
                            }
                        });
                        
                        // Reverse the array to show newest first (since Firebase returns ascending order)
                        videos.reverse();
                        
                        filterVideosByCategory();
                    } else {
                        videosGrid.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; padding: 20px;">No videos found</div>';
                    }
                    
                    loadingContainer.style.display = 'none';
                });
            } catch (error) {
                console.error("Error loading videos:", error);
                loadingContainer.style.display = 'none';
                videosGrid.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; padding: 20px;">Error loading videos. Please try again.</div>';
            }
        }

        // Start rotating links in the share modal
        function startLinkRotation() {
            setInterval(() => {
                currentLinkIndex = (currentLinkIndex + 1) % linksToRotate.length;
            }, 5000); // Rotate every 5 seconds
        }

        // Shuffle array function
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Video player control visibility functions
        function showPlayerControls() {
            clearTimeout(hideControlsTimeout);
            const header = videoPlayer.querySelector('.video-player-header');
            
            if (header) {
                header.style.opacity = '1';
            }
            
            controlsVisible = true;
        }

        function hidePlayerControls() {
            if (isDraggingPlayer) return;
            
            const header = videoPlayer.querySelector('.video-player-header');
            
            if (header) {
                header.style.opacity = '0';
            }
            
            controlsVisible = false;
        }

        function togglePlayerControls() {
            if (controlsVisible) {
                hidePlayerControls();
            } else {
                showPlayerControls();
                startHideControlsTimer();
            }
        }

        function startHideControlsTimer() {
            clearTimeout(hideControlsTimeout);
            hideControlsTimeout = setTimeout(() => {
                if (!isMouseOverPlayer && !isDraggingPlayer) {
                    hidePlayerControls();
                }
            }, 3000); // Hide after 3 seconds of inactivity
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                videoPlayerContainer.requestFullscreen().catch(err => {
                    console.error(`Error attempting to enable fullscreen: ${err.message}`);
                });
            } else {
                document.exitFullscreen();
            }
        }

        // Video player functions
        function showVideoPlayer(video) {
            if (!video || !video.url) {
                console.error("Invalid video data:", video);
                return;
            }
            
            const videoId = getYouTubeId(video.url);
            if (!videoId) {
                console.error("Invalid YouTube URL:", video.url);
                return;
            }
            
            currentPlayingVideo = video;
            
            // Set the title
            videoPlayerTitle.textContent = video.title;
            
            // Set the iframe source
            videoPlayerIframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&playsinline=1&enablejsapi=1&rel=0`;
            
            // Show the player
            videoPlayer.className = 'video-player top-position';
            videoPlayer.style.display = 'block';
            playerPosition = 'top';
            
            // Show loading state
            videoPlayerLoading.style.display = 'flex';
            videoPlayerRefresh.style.display = 'none';
            
            // Setup event listeners for the iframe
            videoPlayerIframe.onload = () => {
                videoPlayerLoading.style.display = 'none';
                videoPlayerRefresh.style.display = 'none';
                showPlayerControls();
                startHideControlsTimer();
            };
            
            videoPlayerIframe.onerror = () => {
                videoPlayerLoading.style.display = 'none';
                videoPlayerRefresh.style.display = 'block';
            };
            
            setupPlayerDrag();
            trackVideoPlay(video);
        }

        function closeVideoPlayer() {
            videoPlayer.style.display = 'none';
            videoPlayerIframe.src = '';
            currentPlayingVideo = null;
            clearTimeout(hideControlsTimeout);
        }

        // Video player drag functionality
        function setupPlayerDrag() {
            const playerHeader = videoPlayerHeader;
            const playerTitle = videoPlayerTitle;
            const playerClose = videoPlayerClose;
            
            if (!playerHeader || !playerTitle || !playerClose) return;
            
            // Remove previous event listeners to avoid duplicates
            playerHeader.removeEventListener('mousedown', startPlayerDrag);
            playerTitle.removeEventListener('mousedown', startPlayerDrag);
            playerClose.removeEventListener('mousedown', (e) => e.stopPropagation());
            
            // Add new event listeners
            playerHeader.addEventListener('mousedown', startPlayerDrag);
            playerTitle.addEventListener('mousedown', startPlayerDrag);
            
            // Prevent close button from triggering drag
            playerClose.addEventListener('mousedown', (e) => {
                e.stopPropagation();
            });
            
            // Touch events
            playerHeader.removeEventListener('touchstart', handleTouchStart);
            playerTitle.removeEventListener('touchstart', handleTouchStart);
            playerClose.removeEventListener('touchstart', (e) => e.stopPropagation());
            
            playerHeader.addEventListener('touchstart', handleTouchStart, { passive: false });
            playerTitle.addEventListener('touchstart', handleTouchStart, { passive: false });
            playerClose.addEventListener('touchstart', (e) => {
                e.stopPropagation();
            }, { passive: false });
            
            // Document-wide event listeners
            document.addEventListener('mousemove', dragPlayer);
            document.addEventListener('mouseup', endPlayerDrag);
            document.addEventListener('touchmove', handleTouchMove, { passive: false });
            document.addEventListener('touchend', endPlayerDrag);
        }

        function handleTouchStart(e) {
            e.preventDefault();
            touchStartTime = Date.now();
            startPlayerDrag(e);
        }

        function handleTouchMove(e) {
            if (Date.now() - touchStartTime > 100) {
                dragPlayer(e);
            }
        }

        function startPlayerDrag(e) {
            e.preventDefault();
            e.stopPropagation();
            
            isDraggingPlayer = true;
            showPlayerControls();
            
            const clientX = e.type === 'mousedown' ? e.clientX : e.touches[0].clientX;
            const clientY = e.type === 'mousedown' ? e.clientY : e.touches[0].clientY;
            
            playerStartX = clientX;
            playerStartY = clientY;
            
            const rect = videoPlayer.getBoundingClientRect();
            playerOffsetX = playerStartX - rect.left;
            playerOffsetY = playerStartY - rect.top;
            
            videoPlayer.classList.add('dragging');
            videoPlayer.style.transition = 'none';
            
            if (playerPosition === 'top') {
                playerDirection = 'down';
            } else if (playerPosition === 'bottom') {
                playerDirection = 'up';
            }
        }

        function dragPlayer(e) {
            if (!isDraggingPlayer) return;
            
            e.preventDefault();
            e.stopPropagation();
            
            let clientX, clientY;
            
            if (e.type === 'mousemove') {
                clientX = e.clientX;
                clientY = e.clientY;
            } else if (e.type === 'touchmove') {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            }
            
            let newX = clientX - playerOffsetX;
            let newY = clientY - playerOffsetY;
            
            const playerWidth = videoPlayer.offsetWidth;
            const playerHeight = videoPlayer.offsetHeight;
            
            newX = Math.max(0, Math.min(newX, window.innerWidth - playerWidth));
            newY = Math.max(0, Math.min(newY, window.innerHeight - playerHeight));
            
            videoPlayer.style.left = `${newX}px`;
            videoPlayer.style.top = `${newY}px`;
            videoPlayer.style.transform = 'none';
            
            if (clientY > playerStartY) {
                playerDirection = 'down';
            } else if (clientY < playerStartY) {
                playerDirection = 'up';
            }
            
            playerStartY = clientY;
        }

        function endPlayerDrag(e) {
            if (!isDraggingPlayer) return;
            
            isDraggingPlayer = false;
            videoPlayer.classList.remove('dragging');
            videoPlayer.style.transition = 'all 0.3s ease';
            
            const rect = videoPlayer.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            if (centerX < window.innerWidth / 3) {
                videoPlayer.classList.remove('right-position');
                videoPlayer.classList.add('left-position');
                videoPlayer.style.left = '20px';
                videoPlayer.style.right = 'auto';
                videoPlayer.style.transform = 'none';
                playerPosition = 'left';
            } else if (centerX > window.innerWidth * 2/3) {
                videoPlayer.classList.remove('left-position');
                videoPlayer.classList.add('right-position');
                videoPlayer.style.left = 'auto';
                videoPlayer.style.right = '20px';
                videoPlayer.style.transform = 'none';
                playerPosition = 'right';
            } else {
                videoPlayer.classList.remove('left-position', 'right-position');
                videoPlayer.style.left = '50%';
                videoPlayer.style.right = 'auto';
                videoPlayer.style.transform = 'translateX(-50%)';
                playerPosition = playerDirection === 'down' ? 'bottom' : 'top';
            }
            
            if (playerDirection === 'down') {
                videoPlayer.classList.remove('top-position');
                videoPlayer.classList.add('bottom-position');
                videoPlayer.style.top = 'auto';
                videoPlayer.style.bottom = '20px';
                videoPlayer.style.transform = playerPosition === 'left' || playerPosition === 'right' ? 'none' : 'translateX(-50%)';
                playerPosition = 'bottom';
            } else {
                videoPlayer.classList.remove('bottom-position');
                videoPlayer.classList.add('top-position');
                videoPlayer.style.top = '20px';
                videoPlayer.style.bottom = 'auto';
                videoPlayer.style.transform = playerPosition === 'left' || playerPosition === 'right' ? 'none' : 'translateX(-50%)';
                playerPosition = 'top';
            }
            
            if (!isMouseOverPlayer) {
                startHideControlsTimer();
            }
        }

        // Video tracking and data management
        function trackVideoPlay(video) {
            if (!video || !video.id) return;
            
            try {
                const videoRef = database.ref(`videos/${video.id}/views`);
                videoRef.transaction((currentViews) => {
                    return (currentViews || 0) + 1;
                });
            } catch (error) {
                console.error("Error tracking video view:", error);
            }
        }

        // Search and filtering functions
function searchVideos() {
    const query = searchInput.value.trim().toLowerCase();
    if (query === '') {
        filterVideosByCategory();
        return;
    }

    const filteredVideos = videos.filter(video => 
        video.enabled && (
            video.title.toLowerCase().includes(query) ||
            (video.description && video.description.toLowerCase().includes(query)) ||
            (video.category && video.category.toLowerCase().includes(query)) ||
            (video.labels && video.labels.some(label => label.toLowerCase().includes(query)))
        )
    );

    displayVideos(filteredVideos);
}

function filterVideosByCategory() {
    let filteredVideos = videos.filter(video => video.enabled);

    if (currentCategory !== 'all') {
        filteredVideos = filteredVideos.filter(video => video.category === currentCategory);
    }

    displayVideos(filteredVideos);
}

// Display videos with shuffle
function displayVideos(videosToDisplay) {
    videosGrid.innerHTML = '';

    if (videosToDisplay.length === 0) {
        videosGrid.innerHTML = `
            <div class="empty-album" style="grid-column: 1 / -1;">
                <i class="fas fa-video-slash"></i>
                <p>No videos found in this category</p>
            </div>
        `;
        return;
    }

    // Shuffle the videos array using Fisher-Yates algorithm
    const shuffledVideos = shuffleArray([...videosToDisplay]);

    shuffledVideos.forEach(video => {
        const videoCard = document.createElement('div');
        videoCard.className = `video-card ${video.enabled ? '' : 'disabled'}`;
        videoCard.innerHTML = `
            <div class="thumbnail">
                <img src="https://img.youtube.com/vi/${getYouTubeId(video.url)}/hqdefault.jpg" alt="${video.title}">
            </div>
            <div class="video-info">
                <div class="video-content">
                    <div class="youtube-logo">
                        <i class="fab fa-youtube"></i>
                        <button class="copy-btn" data-url="${video.url}" title="Copy YouTube Link">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    <div class="video-title">${video.title}</div>
                    ${video.description ? `<div class="video-description">${video.description}</div>` : ''}
                </div>
                <div class="video-badges">
                    ${video.isPremium ? '<span class="premium-badge"><i class="fas fa-crown"></i> Premium</span>' : ''}
                    ${video.category ? `<span class="video-category">${video.category}</span>` : ''}
                </div>
            </div>
            ${!video.enabled ? '<div class="disabled-overlay">Video Disabled</div>' : ''}
        `;

        if (video.enabled) {
            videoCard.addEventListener('click', (e) => {
                if (!e.target.classList.contains('copy-btn') && !e.target.closest('.copy-btn')) {
                    showVideoPlayer(video);
                }
            });
        }

        const copyButton = videoCard.querySelector('.copy-btn');
        if (copyButton) {
            copyButton.addEventListener('click', (e) => {
                e.stopPropagation();
                copyToClipboard(video.url);
                showToast('Video link copied to clipboard!');
            });
        }

        videosGrid.appendChild(videoCard);
    });
}

// Utility functions
function showLoadingSkeleton() {
    videosGrid.innerHTML = '';
    for (let i = 0; i < 8; i++) {
        const skeletonCard = document.createElement('div');
        skeletonCard.className = 'video-card';
        skeletonCard.innerHTML = `
            <div class="thumbnail skeleton skeleton-thumbnail"></div>
            <div class="video-info">
                <div class="video-content">
                    <div class="skeleton skeleton-title"></div>
                    <div class="skeleton skeleton-description"></div>
                    <div class="skeleton skeleton-description"></div>
                </div>
                <div class="video-badges">
                    <div class="skeleton skeleton-meta"></div>
                </div>
            </div>
        `;
        videosGrid.appendChild(skeletonCard);
    }
}

function getYouTubeId(url) {
    if (!url) return null;
    const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
    const match = url.match(regex);
    return match ? match[1] : null;
}

function copyToClipboard(text) {
    if (navigator.clipboard) {
        navigator.clipboard.writeText(text).catch(err => {
            console.error('Failed to copy:', err);
        });
    } else {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
    }
}

function showToast(message) {
    toast.textContent = message;
    toast.classList.add('show');
    setTimeout(() => {
        toast.classList.remove('show');
    }, 2000);
}

function activateSearch() {
    searchBox.classList.add('active');
    appLogo.classList.add('hidden');
    backButton.classList.add('active');
    searchInput.focus();
    titleBar.style.display = 'none';
}

function deactivateSearch() {
    searchBox.classList.remove('active');
    appLogo.classList.remove('hidden');
    backButton.classList.remove('active');
    searchInput.value = '';
    titleBar.style.display = 'flex';
}

function shareContent(platform) {
    const shareUrl = encodeURIComponent(linksToRotate[currentLinkIndex]);
    const shareText = encodeURIComponent('Check out this awesome Santali Premium content!');
    let url;

    switch (platform) {
        case 'telegram':
            url = `https://t.me/share/url?url=${shareUrl}&text=${shareText}`;
            break;
        case 'whatsapp':
            url = `https://wa.me/?text=${shareText}%20${shareUrl}`;
            break;
        case 'facebook':
            url = `https://www.facebook.com/sharer/sharer.php?u=${shareUrl}`;
            break;
        case 'twitter':
            url = `https://twitter.com/intent/tweet?url=${shareUrl}&text=${shareText}`;
            break;
        default:
            return;
    }

    window.open(url, '_blank');
    shareModal.classList.remove('show');
}

function generateUniqueId() {
    return '_' + Math.random().toString(36).substr(2, 9);
}

// Initialize the app
initApp();
    </script>
</body>
</html>